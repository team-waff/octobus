var domain=$("body").data("domain"),baseroot=$("body").data("baseroot");$(document).ready(function(){function t(t,e){$(".parent__view--listing").removeClass("parent__view--active"),$(".parent__view--map").addClass("parent__view--active");var n=L.map("map_parent");if(e)return n.off(),n.remove(),!1;$.getJSON("data/trajet.php").done(function(t){var e=t.start_lat,a=t.start_lng;t.end_lat,t.end_lng;n.setView([e,a],18),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:22,id:"mapbox.streets",accessToken:"pk.eyJ1Ijoib2N0b2J1cyIsImEiOiJjanRrcmt2cnQxdTU5NDRteGluMnpxM2p1In0.Zm24PvVRygwc5BoipCjvMg"}).addTo(n);var i=L.icon({iconUrl:"graphics/marker_start.png",shadowUrl:"graphics/shadow.png",iconSize:[50,50],shadowSize:[50,50],iconAnchor:[25,25],shadowAnchor:[25,25],popupAnchor:[-3,-76]}),o=L.icon({iconUrl:"graphics/marker_end.png",shadowUrl:"graphics/shadow.png",iconSize:[50,50],shadowSize:[50,50],iconAnchor:[25,25],shadowAnchor:[25,25],popupAnchor:[-3,-76]}),r=L.icon({iconUrl:"graphics/marker_moving.png",shadowUrl:"graphics/shadow.png",iconSize:[50,50],shadowSize:[50,50],iconAnchor:[25,25],shadowAnchor:[25,25],popupAnchor:[-3,-76]});L.marker([t.end_lat,t.end_lng],{icon:o}).addTo(n);var s=L.marker([e,a],{icon:r}).addTo(n),c=!1;setInterval(function(){$.getJSON("data/trajet.php").done(function(t){var e=t.status;console.log(e),"riding"==e&&(c||L.marker([t.start_lat,t.start_lng],{icon:i}).addTo(n),c=!0,n.removeLayer(s),s=L.marker([t.now_lat,t.now_lng],{icon:r}).addTo(n),L.circle([t.now_lat,t.now_lng],{color:"#2297c9",fillColor:"#fff",fillOpacity:1,radius:2}).addTo(n),n.panTo([t.now_lat,t.now_lng]))})},2e3)})}$(".js_login").click(function(t){t.preventDefault();var e=0;$(".login__form").find(".form__input").each(function(){""==$(this).val()?(e++,$(this).parents(".form__line").addClass("form__line--error")):$(this).parents(".form__line").removeClass("form__line--error")}),0==e&&("enfant"==$("input[name=username]").val()?window.location.href="enfant.php":window.location.href="parent_choice.php")}),$(".json_listing_children").is(":visible")&&function(){$.getJSON("app/accountable/4").done(function(t){console.info(t,1),$(".js_redirect_parent").attr("data-id",t.pk),$(".json_listing_parent__item-firstname").text(t.firstname),$(".json_listing_parent__item-lastname").text(t.name);for(var e=0,n=t.childs.length;e<n;e++)$(".json_listing_children__item").last().clone(!0).appendTo(".json_listing_children").attr("data-id",t.childs[e].pk).find(".json_listing_children__item-firstname").text(t.childs[e].firstname).parents(".json_listing_children__item").find(".json_listing_children__item-lastname").text(t.childs[e].name).parents(".json_listing_children__item").find(".json_listing_children__item-picture").attr("src","graphics/avatar_"+t.childs[e].avatar+".png");$(".json_listing_children").find(".json_listing_children__item").first().remove()})}(),$("body").on("click",".js_redirect_child",function(t){t.preventDefault();var e=$(this).parents(".json_listing_children__item").data("id");window.location.href="enfant.php?id="+e}),$("body").on("click",".js_redirect_parent",function(t){t.preventDefault();var e=$(this).data("id");window.location.href="parent.php?id="+e}),$(".json_children_active").is(":visible")&&function(){$.getJSON("app/accountable/4").done(function(t){for(var e=0,n=t.childs.length;e<n;e++)$(".json_children_active__item").last().clone(!0).appendTo(".json_children_active").attr("data-id",t.childs[e].pk).find(".json_children_active-firstname").text(t.childs[e].firstname).parents(".json_children_active__item").find(".json_children_active-lastname").text(t.childs[e].name).parents(".json_children_active__item").find(".json_children_active-picture").attr("src","graphics/avatar_"+t.childs[e].avatar+".png");$(".json_children_active").find(".json_children_active__item").first().remove(),$(".json_children_active__item").each(function(){var t=$(this).data("id");$.getJSON("app/child/"+t).done(function(e){console.info(e,1);for(var n=0,a=e.rides.length;n<a;n++){var i=new Date(e.rides[n].start_time);$(".json_children_active__item[data-id="+t+"]").find(".json_trajets .json_trajet_active").last().clone(!0).appendTo(".json_children_active__item[data-id="+t+"] .json_trajets").attr("data-id",e.rides[n].course.pk).attr("data-status",e.rides[n].status).attr("data-name",e.firstname).find(".json_trajet_active_start").text(i.getDate()+"/"+i.getMonth()+" - "+i.getHours()+":"+i.getMinutes()).parents(".json_trajet_active").find(".json_trajet_active_place").text(e.rides[n].course.name).parents(".json_trajet_active").find(".json_trajet_active_status").attr("data-status",e.rides[n].status)}})})})}(),$("body").on("click",".json_trajet_active",function(e){e.preventDefault();var n=$(this).data("status"),a=$(this).data("id"),i=$(this).data("name");$(".json_map_name").text(i),"running"!=n&&"start"!=n||(t(a,!0),t(a,!1))}),$("body").hasClass("page_parent")});var domain=$("body").data("domain"),baseroot=$("body").data("baseroot");$(document).ready(function(){function t(t){$("body").addClass("no_scroll"),$(".popup").removeClass("popup--visible"),$(".popup[data-popup="+t+"]").addClass("popup--visible")}function e(t){$("body").removeClass("no_scroll"),$(".popup[data-popup="+t+"]").removeClass("popup--visible")}$(".js_menu_close").on("click",function(t){t.preventDefault(),$(".menu").removeClass("menu--open")}),$(".js_menu_open").on("click",function(t){t.preventDefault(),$(".menu").addClass("menu--open")}),$(".js_open_popup").on("click",function(e){e.preventDefault(),t($(this).data("popup"))}),$(".js_close_popup").on("click",function(t){t.preventDefault(),e($(this).data("popup"))})});var domain=$("body").data("domain"),baseroot=$("body").data("baseroot");$(document).ready(function(){function t(){var t=new TimelineMax,e=$(".open .enter-anim");t.staggerTo(e,.3,{left:20,autoAlpha:1},.1)}function e(){var t=new TimelineMax,e=$(".enter-anim");t.set(e,{left:0,autoAlpha:0})}function n(e){if(!$(".global--enfant.animating").length){$(".global--enfant").addClass("animating");var n=new TimelineMax,a=$(".slide[data-slide="+e+"]");a.addClass("open"),t(),"select"==e&&i("John","terry"),n.to(a,.5,{left:0,ease:Power3.easeOut,onComplete:s})}}function a(t,e){if(!$(".global--enfant.animating").length){$(".global--enfant").addClass("animating");var n=new TimelineMax,a=e;a.removeClass("open"),n.to(a,.3,{css:{left:"100%"},ease:Power3.easeIn,onComplete:c})}}function i(t,e){var t=t,e=e;$("#select_child").append("<option>"+(t||"Empty")+"</option>"),$("#select_child").append("<option>"+(e||"Empty")+"</option>"),$("#select_child").selectric("refresh")}function o(t){$(".select_day_bloc").show()}function r(t){$(".select_hour_bloc").show()}var s=function(){$(".global--enfant").removeClass("animating")},c=function(){$(".global--enfant").removeClass("animating"),e()};$(".btn_slide").click(function(t){t.preventDefault(),n($(this).data("direction"))}),$(".btn--return").click(function(t){t.preventDefault();var e=$(this).parents(".slide");a($(this).data("direction"),e)}),$(".select").selectric(),$("#select_child").on("change",function(){o($(this).val())}),$("#select_day").on("change",function(){r($(this).val())}),$("#select_hour").on("change",function(){$(this).val();$(".btn_bloc_valid").show()}),$(".slider_avatar").slick({dots:!1,arrow:!0,infinite:!0,speed:300,centerMode:!0}),$(".btn--validation_avatar").click(function(t){if(t.preventDefault(),!$(this).parents(".slider_avatar_item.locked").length){var e=$(this).parents(".slider_avatar_item").find("img").attr("src");$(".avatar_inner img").attr("src",e),$(".slide--avatar .btn--return").trigger("click")}}),$(".btn--return").click(function(t){t.preventDefault();var e=$(this).parents(".slide");a($(this).data("direction"),e)})});
var domain=$("body").data("domain"),baseroot=$("body").data("baseroot");$(document).ready(function(){function t(t,n){$(".parent__view--listing").removeClass("parent__view--active"),$(".parent__view--map").addClass("parent__view--active");var e=L.map("map_parent",{zoomControl:!1});if(n)return e.off(),e.remove(),!1;$.getJSON("app/course/1").done(function(t){var n=t.start_pos.lat,i=t.start_pos.lng;e.setView([n,i],16),L.tileLayer("https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',id:"mapbox.streets",zoomControl:!1,accessToken:"pk.eyJ1Ijoib2N0b2J1cyIsImEiOiJjanRrcmt2cnQxdTU5NDRteGluMnpxM2p1In0.Zm24PvVRygwc5BoipCjvMg"}).addTo(e);var o=L.icon({iconUrl:"graphics/marker_start.png",shadowUrl:"graphics/shadow.png",iconSize:[50,50],shadowSize:[50,50],iconAnchor:[25,25],shadowAnchor:[25,25],popupAnchor:[-3,-76]}),s=L.icon({iconUrl:"graphics/marker_end.png",shadowUrl:"graphics/shadow.png",iconSize:[50,50],shadowSize:[50,50],iconAnchor:[25,25],shadowAnchor:[25,25],popupAnchor:[-3,-76]}),r=L.icon({iconUrl:"graphics/marker_moving.png",shadowUrl:"graphics/shadow.png",iconSize:[50,50],shadowSize:[50,50],iconAnchor:[25,25],shadowAnchor:[25,25],popupAnchor:[-3,-76]});L.marker([t.points[t.points.length-1].lat,t.points[t.points.length-1].lng],{icon:s}).addTo(e);for(var c=L.marker([n,i],{icon:r}).addTo(e),l=0,d=t.points.length;l<d;l++)L.circle([t.points[l].lat,t.points[l].lng],{color:"#2297c9",fillColor:"#fff",fillOpacity:1,radius:2}).addTo(e);var p=!1,_=0;status_bus="riding",interval=setInterval(function(){var n=t.points[_].lat,i=t.points[_].lng;"riding"==status_bus&&(p||L.marker([t.start_pos.lat,t.start_pos.lng],{icon:o}).addTo(e),p=!0,e.removeLayer(c),c=L.marker([n,i],{icon:r}).addTo(e),e.panTo([n,i])),console.log(status_bus),_==t.points.length-1?(status_bus="stop",a(),window.clearInterval(interval)):_++},1500)})}function a(){$(".notif").addClass("notif--visible")}$(".js_login").click(function(t){t.preventDefault();var a=0;$(".login__form").find(".form__input").each(function(){""==$(this).val()?(a++,$(this).parents(".form__line").addClass("form__line--error")):$(this).parents(".form__line").removeClass("form__line--error")}),0==a&&("enfant"==$("input[name=username]").val()?window.location.href="enfant.php?id=14":window.location.href="parent_choice.php")}),$(".json_listing_children").is(":visible")&&function(){$.getJSON("app/accountable/4").done(function(t){console.info(t,1),$(".js_redirect_parent").attr("data-id",t.pk),$(".json_listing_parent__item-firstname").text(t.firstname),$(".json_listing_parent__item-lastname").text(t.name);for(var a=0,n=t.childs.length;a<n;a++)$(".json_listing_children__item").last().clone(!0).appendTo(".json_listing_children").attr("data-id",t.childs[a].pk).find(".json_listing_children__item-firstname").text(t.childs[a].firstname).parents(".json_listing_children__item").find(".json_listing_children__item-lastname").text(t.childs[a].name).parents(".json_listing_children__item").find(".json_listing_children__item-picture").attr("src","graphics/avatar_"+t.childs[a].avatar+".png");$(".json_listing_children").find(".json_listing_children__item").first().remove()})}(),$("body").on("click",".js_redirect_child",function(t){t.preventDefault();var a=$(this).parents(".json_listing_children__item").data("id");window.location.href="enfant.php?id="+a}),$("body").on("click",".js_redirect_parent",function(t){t.preventDefault();var a=$(this).data("id");window.location.href="parent.php?id="+a}),$(".json_children_active").is(":visible")&&function(){$.getJSON("app/accountable/4").done(function(t){for(var a=0,n=t.childs.length;a<n;a++)$(".json_children_active__item").last().clone(!0).appendTo(".json_children_active").attr("data-id",t.childs[a].pk).find(".json_children_active-firstname").text(t.childs[a].firstname).parents(".json_children_active__item").find(".json_children_active-lastname").text(t.childs[a].name).parents(".json_children_active__item").find(".json_children_active-picture").attr("src","graphics/avatar_"+t.childs[a].avatar+".png");$(".json_children_active").find(".json_children_active__item").first().remove(),$(".json_children_active__item").each(function(){var t=$(this).data("id");$.getJSON("app/child/"+t).done(function(a){console.info(a,1);for(var n=0,e=a.rides.length;n<e;n++){var i=new Date(a.rides[n].start_time);$(".json_children_active__item[data-id="+t+"]").find(".json_trajets .json_trajet_active").last().clone(!0).appendTo(".json_children_active__item[data-id="+t+"] .json_trajets").attr("data-id",a.rides[n].course.pk).attr("data-status",a.rides[n].status).attr("data-name",a.firstname).attr("data-avatar",a.avatar).find(".json_trajet_active_start").text(i.getDate()+"/"+i.getMonth()+" - "+i.getHours()+":"+i.getMinutes()).parents(".json_trajet_active").find(".json_trajet_active_place").text(a.rides[n].course.name).parents(".json_trajet_active").find(".json_trajet_active_status").attr("data-status",a.rides[n].status)}})})})}(),$("body").on("click",".json_trajet_active",function(a){a.preventDefault();var n=$(this).data("status"),e=$(this).data("id"),i=$(this).data("name"),o=$(this).data("avatar");$(".json_map_name").text(i),$(".json_map_avatar").attr("src","graphics/avatar_"+o+".png"),"running"!=n&&"start"!=n||(t(e,!0),t(e,!1))}),$(".notif--visible").click(function(){$(this).removeClass("notif--visible")}),$(".btn--return-parent").click(function(t){t.preventDefault(),$(".parent__view--listing").addClass("parent__view--active"),$(".parent__view--map").removeClass("parent__view--active")})});var domain=$("body").data("domain"),baseroot=$("body").data("baseroot");$(document).ready(function(){function t(t){$("body").addClass("no_scroll"),$(".popup").removeClass("popup--visible"),$(".popup[data-popup="+t+"]").addClass("popup--visible")}function a(t){$("body").removeClass("no_scroll"),$(".popup[data-popup="+t+"]").removeClass("popup--visible")}$(".js_menu_close").on("click",function(t){t.preventDefault(),$(".menu").removeClass("menu--open")}),$(".js_menu_open").on("click",function(t){t.preventDefault(),$(".menu").addClass("menu--open")}),$(".js_open_popup").on("click",function(a){a.preventDefault(),t($(this).data("popup"))}),$(".js_close_popup").on("click",function(t){t.preventDefault(),a($(this).data("popup"))})});var domain=$("body").data("domain"),baseroot=$("body").data("baseroot");$(document).ready(function(){function t(){var t=new TimelineMax,a=$(".open .enter-anim");t.staggerFrom(a,.3,{left:-60,autoAlpha:0},.1)}function a(){var t=new TimelineMax,a=$(".enter-anim");t.set(a,{left:0,autoAlpha:1})}function n(a){if(!$(".global--enfant.animating").length){$(".global--enfant").addClass("animating");var n=new TimelineMax,e=$(".slide[data-slide="+a+"]");e.addClass("open"),t(),"select"==a&&i("John","terry"),n.to(e,.5,{left:0,ease:Power3.easeOut,onComplete:s})}}function e(t,a){if(!$(".global--enfant.animating").length){$(".global--enfant").addClass("animating");var n=new TimelineMax,e=a;e.removeClass("open"),n.to(e,.3,{css:{left:"100%"},ease:Power3.easeIn,onComplete:r})}}function i(t,a){var t=t;$("#select_child").append("<option>"+(t||"Empty")+"</option>"),$("#select_child").selectric("refresh")}function o(t){$(".select_day_bloc").show()}var s=function(){$(".global--enfant").removeClass("animating")},r=function(){$(".global--enfant").removeClass("animating"),a()};$(".btn_slide").click(function(t){t.preventDefault(),n($(this).data("direction"))}),$(".btn--return").click(function(t){t.preventDefault();var a=$(this).parents(".slide");e($(this).data("direction"),a)}),n("select"),$(".select").selectric(),$("#select_child").on("change",function(){o($(this).val())}),$("#select_day").on("change",function(){$(this).val();$(".btn_bloc_valid").show()}),$(".slider_avatar").slick({dots:!1,arrow:!0,infinite:!0,speed:300,centerMode:!0}),$(".btn--validation_avatar").click(function(t){if(t.preventDefault(),!$(this).parents(".slider_avatar_item.locked").length){var a=$(this).parents(".slider_avatar_item").find("img").attr("src");$(".avatar_inner img").attr("src",a),$(".slide--avatar .btn--return").trigger("click")}}),$(".btn--return").click(function(t){t.preventDefault();var a=$(this).parents(".slide");e($(this).data("direction"),a)})});